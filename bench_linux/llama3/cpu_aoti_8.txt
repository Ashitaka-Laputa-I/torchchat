python3 torchchat.py export llama3 --quantize '{"linear:int8": {"groupsize": 0}, "precision": {"dtype":"bfloat16"}, "executor":{"accelerator":"cpu"}}' --output-dso-path /tmp/model8.so
python3 torchchat.py generate llama3 --dso-path /tmp/model8.so --prompt "Once upon a time," --max-new-tokens 256 --device cpu --num-samples 3
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
python3 torchchat.py export llama3 --quantize '{"linear:int8": {"groupsize": 0}, "precision": {"dtype":"bfloat16"}, "executor":{"accelerator":"cpu"}}' --output-dso-path /tmp/model8.so
Note: NumExpr detected 22 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
NumExpr defaulting to 16 threads.
PyTorch version 2.5.0.dev20240728+cu121 available.
Using device=cpu
Setting max_seq_length to 300 for DSO export.
Loading model...
Time to load model: 0.41 seconds
Quantizing the model with: {'linear:int8': {'groupsize': 0}, 'precision': {'dtype': 'bfloat16'}, 'executor': {'accelerator': 'cpu'}}
Time to quantize model: 35.19 seconds
-----------------------------------------------------------
Exporting model using AOT Inductor to /tmp/model8.so
The generated DSO model can be found at: /tmp/model8.so
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
python3 torchchat.py generate llama3 --dso-path /tmp/model8.so --prompt "Once upon a time," --max-new-tokens 256 --device cpu --num-samples 3
Note: NumExpr detected 22 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 16.
NumExpr defaulting to 16 threads.
PyTorch version 2.5.0.dev20240728+cu121 available.
Warning: checkpoint path ignored because an exported DSO or PTE path specified
Warning: checkpoint path ignored because an exported DSO or PTE path specified
Using device=cpu Intel(R) Xeon(R) Platinum 8339HC CPU @ 1.80GHz
Loading model...
Time to load model: 0.38 seconds
-----------------------------------------------------------
Once upon a time, there was a young boy named Jack who lived in a small village surrounded by a dense forest. Jack was a curious boy who loved to explore the forest and play in its many wonders.
One day, Jack stumbled upon a hidden path he had never seen before. The path was winding and narrow, and it seemed to lead deep into the heart of the forest. Jack's curiosity got the better of him, and he decided to follow the path to see where it would take him.

As he walked, the path grew darker and more overgrown. The trees seemed to close in around him, casting long, ominous shadows on the ground. Jack began to feel a sense of unease, but he was determined to see what lay at the end of the path.

After a while, the path opened up into a clearing. In the center of the clearing stood an enormous tree, its trunk twisted and gnarled with age. The tree seemed to be... breathing? Its branches were swaying gently in the breeze, and Jack could have sworn he saw the trunk slowly expanding and contracting.

Suddenly, a figure appeared at the base of the tree. It was an old man with a long white beard and a twinkle in his eye. He beckoned to Jack, and Jack
Time for inference 1: 157.46 sec total, time to first token 4.76 sec with sequential prefill, 255 tokens, 1.62 tokens/sec, 617.49 ms/token
Bandwidth achieved: 26.01 GB/s
*** This first iteration will include cold start effects for dynamic import, hardware caches. ***
Once upon a time, I was a freelance content writer. I wrote about a wide range of topics, from technology and business to lifestyle and entertainment. My writing was published on various platforms, including websites, blogs, and social media.
One day, I received an email from a potential client who wanted me to write a series of articles for their company blog. They provided me with a list of topics and a brief overview of each one. I was excited to take on the project and get started.
As I began writing, I realized that I had a lot of freedom to create content that was engaging and relevant to the client's audience. I was able to use my creativity and expertise to craft articles that were not only informative but also entertaining and easy to read.
The client was thrilled with the final product and asked me to continue writing for their blog on a regular basis. I was happy to oblige and continued to write articles that were well-received by the client's audience.
As a freelance content writer, I learned the importance of understanding my audience and creating content that resonates with them. I also learned the value of flexibility and being able to adapt to different topics and styles.
Overall, my experience as a freelance content writer taught me the importance of writing engaging and relevant content that meets the
Time for inference 2: 96.96 sec total, time to first token 1.61 sec with sequential prefill, 255 tokens, 2.63 tokens/sec, 380.24 ms/token
Bandwidth achieved: 42.24 GB/s
Once upon a time, in the land of the East, there was a young man named Anil. He was a skilled craftsman who specialized in creating intricate wooden carvings. Anil lived in a small village surrounded by lush green forests, where he spent most of his days working on his craft.

One day, while out on a walk, Anil stumbled upon a hidden clearing. In the center of the clearing stood an enormous tree, its trunk as wide as a house and its branches stretching towards the sky. The tree was unlike any Anil had ever seen before, its bark shimmering with a soft, ethereal light.

As Anil approached the tree, he felt an inexplicable sense of peace wash over him. He reached out to touch the trunk, and as he did, he heard a gentle voice whispering in his ear.

"Welcome, Anil. I have been waiting for you. You possess a skill that is rare and precious, and I require your help. I am the guardian of this forest, and I need your expertise to create a magnificent wooden door for my abode."

Anil was both amazed and honored by the tree's request. He accepted the task and set to work immediately. For many days and nights, he toiled, his ch
Time for inference 3: 180.46 sec total, time to first token 1.18 sec with sequential prefill, 255 tokens, 1.41 tokens/sec, 707.68 ms/token
Bandwidth achieved: 22.69 GB/s

========================================

Average tokens/sec: 1.89
Memory used: 0.00 GB
